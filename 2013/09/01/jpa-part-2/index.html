<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="sinujohn">
<meta name="description" content="This is continued from JPA: part 1. Other Annotations:  @Table(name = &amp;ldquo;TABLENAME&amp;rdquo;)  Used before class name to explicitly specify table name.   @Column(name = &amp;ldquo;COLUMN_NAME&amp;rdquo;)  Used before instance variables to explicitly set column names.    Example:
@Entity @Table(name = &amp;quot;EMP&amp;quot;) public class Employee { @Id @Column(name = &amp;quot;EMP_ID&amp;quot;) private int id; @Column(name = &amp;quot;EMP_NAME&amp;quot;) private String name; //getters and setters }  this maps to Table: EMP" />
<meta name="keywords" content=", java, jpa" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://sinujohn.github.io/2013/09/01/jpa-part-2/" />


    <title>
        
            JPA - Part 2 :: Sinu John  â€” Cogito, ergo sum
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.min.7bfbbe12786fa0ded4b4c0d792cbb36a5bd0bdb0b856dde57aa7b1f6fe0f2b87.css">




    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#252627">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="msapplication-TileColor" content="#252627">
    <meta name="theme-color" content="#252627">

<meta itemprop="name" content="JPA - Part 2">
<meta itemprop="description" content="This is continued from JPA: part 1. Other Annotations:  @Table(name = &ldquo;TABLENAME&rdquo;)  Used before class name to explicitly specify table name.   @Column(name = &ldquo;COLUMN_NAME&rdquo;)  Used before instance variables to explicitly set column names.    Example:
@Entity @Table(name = &quot;EMP&quot;) public class Employee { @Id @Column(name = &quot;EMP_ID&quot;) private int id; @Column(name = &quot;EMP_NAME&quot;) private String name; //getters and setters }  this maps to Table: EMP">


<meta itemprop="datePublished" content="2013-09-01T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2013-09-01T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="551">



<meta itemprop="keywords" content="java,jpa," />
<meta property="og:title" content="JPA - Part 2" />
<meta property="og:description" content="This is continued from JPA: part 1. Other Annotations:  @Table(name = &ldquo;TABLENAME&rdquo;)  Used before class name to explicitly specify table name.   @Column(name = &ldquo;COLUMN_NAME&rdquo;)  Used before instance variables to explicitly set column names.    Example:
@Entity @Table(name = &quot;EMP&quot;) public class Employee { @Id @Column(name = &quot;EMP_ID&quot;) private int id; @Column(name = &quot;EMP_NAME&quot;) private String name; //getters and setters }  this maps to Table: EMP" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://sinujohn.github.io/2013/09/01/jpa-part-2/" />

<meta property="og:image" content="https://sinujohn.github.io/" />
<meta property="article:published_time" content="2013-09-01T00:00:00+00:00" />
<meta property="article:modified_time" content="2013-09-01T00:00:00+00:00" /><meta property="og:site_name" content="Sinu John" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://sinujohn.github.io/"/>

<meta name="twitter:title" content="JPA - Part 2"/>
<meta name="twitter:description" content="This is continued from JPA: part 1. Other Annotations:  @Table(name = &ldquo;TABLENAME&rdquo;)  Used before class name to explicitly specify table name.   @Column(name = &ldquo;COLUMN_NAME&rdquo;)  Used before instance variables to explicitly set column names.    Example:
@Entity @Table(name = &quot;EMP&quot;) public class Employee { @Id @Column(name = &quot;EMP_ID&quot;) private int id; @Column(name = &quot;EMP_NAME&quot;) private String name; //getters and setters }  this maps to Table: EMP"/>



    <meta property="article:section" content="Tuts" />



    <meta property="article:published_time" content="2013-09-01 00:00:00 &#43;0000 UTC" />








    </head>

    <body class="dark-theme">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">$ cd /home/</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://sinujohn.github.io/post/">Posts</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="https://sinujohn.github.io/2013/09/01/jpa-part-2/">JPA - Part 2</a></h2>

            

            <div class="post-content">
                <p>This is continued from <a href="/2013/08/31/jpa-part-1/">JPA: part 1</a>.
<h2>Other Annotations:</h2>
<ul>
    <li><strong>@Table(name = &ldquo;TABLENAME&rdquo;)</strong>
<ul>
    <li>Used before class name to explicitly specify table name.</li>
</ul>
</li>
    <li><strong>@Column(name = &ldquo;COLUMN_NAME&rdquo;)</strong>
<ul>
    <li>Used before instance variables to explicitly set column names.</li>
</ul>
</li>
</ul>
<h3>Example:</h3></p>

<pre><code class="language-java">@Entity
@Table(name = &quot;EMP&quot;)
public class Employee {
    @Id
    @Column(name = &quot;EMP_ID&quot;)
    private int id;

    @Column(name = &quot;EMP_NAME&quot;)
    private String name;

    //getters and setters
}
</code></pre>

<p>this maps to
Table: <strong>EMP</strong></p>

<pre><code> --------------------------
 | EMP_ID (PK) | EMP_NAME |
 --------------------------
 |_____________|__________|
</code></pre>

<p>JPA automatically maps &lsquo;int&rsquo; to &lsquo;NUMBER&rsquo; and &lsquo;String&rsquo; to &lsquo;CHAR&rsquo; or &lsquo;VARCHAR&rsquo;. But it cannot automatically convert Date or Time datatypes. So we need to specify the Temporal type to be used. (Temporal = related to time)
<h2>Other Annotations:</h2>
<ul>
    <li><strong>@Temporal(TemporalType.TYPE)</strong>
<ul>
    <li>TYPE can be DATE, TIME or TIMESTAMP. Used before &lsquo;Date&rsquo; or &lsquo;Calendar&rsquo; datatypes. Oracle only has DATE datatype. It doesn&rsquo;t have TIME or TIMESTAMP.</li>
</ul>
</li>
    <li><strong>@Transient</strong>
<ul>
    <li>Used before those instance variables that need not be persisted.</li>
</ul>
</li>
</ul>
<h3>Example:</h3></p>

<pre><code>@Entity
public class Student {
    @Id
    private int regNo;
    private String name;

    @Temporal(TemporalType.DATE)
    private Calendar dob; //'dob' column od database is of 'DATE' datatype

    private int mark1;
    private int mark2;
    private int mark3;

    @Transient
    private float averageMark; //Not stored in database

    //getters and setters
}
</code></pre>

<p><h2></h2>
<h2>Configuring JPA</h2>
Configure &lsquo;persistence unit&rsquo; in &lsquo;<strong>persistence.xml</strong>&lsquo;:
Persistence unit name is specified as:</p>

<pre><code>&lt;persistence-unit name=&quot;EmployeeService&quot; transaction-type=&quot;RESOURCE_LOCAL&quot;&gt;
</code></pre>

<p>Here <em>EmployeeService</em> is the persistence unit.</p>

<p>We should then specify all Entity classes that need to be persisted in <code>&lt;class&gt;</code> tags</p>

<pre><code>&lt;class&gt;me.sinu.entity.Entity1&lt;/class&gt;
&lt;class&gt;me.sinu.entity.Entity2&lt;/class&gt;
&lt;class&gt;me.sinu.entity.Entity3&lt;/class&gt;
</code></pre>

<p>We then configure the db related stuff like URL,username,password etc.</p>

<pre><code>&lt;properties&gt;
    &lt;property name=&quot;toplink.jdbc.url&quot; value=&quot;jdbc:oracle:thin:@127.0.0.1:1521/db&quot;/&gt;
    &lt;property name=&quot;toplink.jdbc.user&quot; value=&quot;username&quot;/&gt;
    &lt;property name=&quot;toplink.jdbc.password&quot; value=&quot;password&quot;/&gt;
    &lt;property name=&quot;toplink.jdbc.driver&quot; value=&quot;oracle.jdbc.driver.OracleDriver&quot;/&gt;
    &lt;property name=&quot;toplink.ddl-generation&quot; value=&quot;create-tables&quot;/&gt;
&lt;/properties&gt;
</code></pre>

<p>This is for TopLink implementation of JPA to connect to Oracle. It might be different for other implementations.
<h2>Persisting an Entity using JPA</h2>
<ol>
    <li>Creating an instance of &lsquo;<strong>EntityManagerFactory</strong>&lsquo;
<ul>
    <li>Persistence.createEntityManagerFactory(persistence-unit_name_defined_in_xml_file)</li>
</ul>
</li>
    <li>Obtaining an instanceof &lsquo;<strong>EntityManager</strong>&lsquo;</li>
    <li>Persist the Entity
<ul>
    <li>Begin EntityTransaction</li>
    <li>Invoke <strong>persist()</strong></li>
    <li>Commit the transaction</li>
</ul>
</li>
</ol>
<h3>Example:</h3></p>

<pre><code>EntityManagerFactory emf = Persistence.createEntityManagerFactory(&quot;EmployeeService&quot;);
EntityManager em = emf.createEntityManager();
EntityTransaction et = em.getTransaction();
if(et==null) {
    //ERROR. Cannot obtain transaction
    return;
}
et.begin(); //begin transaction
    Employee emp = new Employee();
    emp.setEmpId(101);
    emp.setName(&quot;sinu&quot;);
    em.persist(emp); //persist the data
et.commit(); //ending transaction
</code></pre>

<p>When we call em.persist(), data is sent to the database and it is stored in DB Buffer. It is not yet updated in the table. When we call em.commit(), the data gets updated in the table.
<h2>Finding an Entity</h2>
To find an entity, we need not begin a transaction. We can find it using EntityManager.
Syntax:
<strong>EntityManager.find(EntityClassName.class, PrimaryKey)</strong>
<h3>Example:</h3></p>

<pre><code>Employee empl = em.find(Employee.class, 101);
</code></pre>

<p>Here 101 is the empId(primary key) to be searched.</p>

<p>If table doesn&rsquo;t exist or record is not present, it returns null.
<h2>Updating an Entity</h2>
Once we find an entity, the entity object in the heap memory gets a connection to the table. So,if we modify the object, the table also gets updated.
An object which is connected to a table(relation) is called &lsquo;<strong>Managed Object</strong>&rsquo;. If we update the Managed Object, the table also gets updated.
<h3>Example:</h3></p>

<pre><code>EntityTransaction et = em.getTransaction();
et.begin();
    Employee empl = em.find(Employee.class, 101);
    //empl is now a Managed Object. We can now modify it
    if(empl!=null) {
        empl.setSalary(empl.getSalary()+1000);
    }
et.commit();
</code></pre>

<p><h2>Removing an Entity</h2>
This is similar to update. Once we find the object we call <strong>EntityManager.remove(entityObject)</strong>
<h3>Example:</h3></p>

<pre><code class="language-java">EntityTransaction et = em.getTransaction();
et.begin();
    Employee empl = em.find(Employee.class, 101);
    //empl is now a Managed Object. We can now modify it
    if(empl!=null) {
        em.remove(empl)
    }
et.commit();
</code></pre>

            </div>
        </article>

        <hr />

        <div class="post-info">
  				<p>
  					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="https://sinujohn.github.io/tags/java">java</a></span><span class="tag"><a href="https://sinujohn.github.io/tags/jpa">jpa</a></span>
  				</p>
  		</div>
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2020</span>
            
                <span><a href="https://sinujohn.github.io/">Sinu John</a></span>
            
            <span><a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener">CC BY-SA 4.0</a></span>
            <span> <a href="https://sinujohn.github.io/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084; by <a href="https://github.com/rhazdon">Djordje Atlialp</a></span>
        </div>
    </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="/bundle.min.2d5469329143160ae2456a69c3c76dc2d0a3b212b46afe291a51bd68650ed6f8697e001dab54f1c272c77ce08092a8c55e5bb4314e0ee334aab4b927ec896638.js" integrity="sha512-LVRpMpFDFgriRWppw8dtwtCjshK0av4pGlG9aGUO1vhpfgAdq1TxwnLHfOCAkqjFXlu0MU4O4zSqtLkn7IlmOA=="></script>
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-96151225-1', 'auto');
        ga('send', 'pageview');
    </script>



    </body>
</html>
